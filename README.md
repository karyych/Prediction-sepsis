# Прогнозирование сепсиса и септического шока

## Обзор 
Этот репозиторий содержит две модели машинного обучения, ANN (Искусственная Нейронная Сеть) и LSTM (Долгая Краткосрочная Память), предназначенные для диагностики пациентов с сепсисом и септическим шоком. Модели классифицируют заболевание на основе жизненно важных показателей и прогнозируют прогрессирование заболевания с течением времени.

## Модели 

### модель LSTM 
Модель LSTM классифицирует заболевание на основе жизненно важных показателей. Используемые характеристики: 
- HR (Частота Сердечных Сокращений)
- O2Sat (Насыщение Крови Кислородом)
- Temp (Температура)
- MAP (Среднее Артериальное Давление)
- Resp (Частота Дыхания)
- Glucose (Уровень Глюкозы)
- Lactate (Уровень Лактата)
- WBC (Число Белых Кровяных Клеток)
- Hgb (Гемоглобин)
- Platelets (Тромбоциты)
- Age (Возраст)
- Gender (Пол)
- SepsisLabel (Наличие Сепсиса) 

Целевая переменная `SepsisLabel` — это бинарная переменная, указывающая на наличие (1) или отсутствие (0) сепсиса.

**Точность:** 98% 

### Модель ANN
Модель ANN прогнозирует прогрессирование заболевания с течением времени, оценивая состояние пациента по шкале SOFA (Sequential Organ Failure Assessment). Некоторые показатели были переведены в шкалы для оценки состояния по SOFA. 

**Точность:** 85% 

## Оркестрация Метамодели 
Модели объединены в метамодель, которая оркестрирует их работу параллельно с помощью MLflow. Непрерывное обучение и обновления управляются Apache Airflow, который запускает DAG (Directed Acyclic Graph) в определенные моменты времени.
 
 ### MLflow 
 MLflow используется для сбора метрик и отслеживания производительности моделей. 

 ### База данных 
 Данные хранятся и обновляются в базе данных PostgreSQL 16. 

 ### Redis
Для оптимизации времени обработки данных моделями используется Redis. Данные из базы данных PostgreSQL отправляются в Redis для более быстрого доступа.

## Структура проекта 
├── DAG
│   └── airflow_dag.py       # Определения DAG для Apache Airflow <br>
├── JUPYTER                                                       <br>
│   ├── ANN.ipynb            # Jupyter Notebook для модели ANN    <br>
│   └── LSTM.ipynb           # Jupyter Notebook для модели LSTM   <br>
├── MLflow                                                        <br>
│   └── Meta-model.py        # Скрипт оркестрации метамодели      <br>
├── MODELS                                                        <br>
│   ├── ANN.py               # Определение и обучение модели ANN  <br>
│   └── LSTM.py              # Определение и обучение модели LSTM <br>
├── dockerfile               # Dockerfile для развертывания проекта <br>
└── README.md                # Документация проекта                <br>

